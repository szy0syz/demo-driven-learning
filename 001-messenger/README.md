# Hexagonal Architecture

Hexagonal Architecture，也称为端口和适配器架构（Ports and Adapters Architecture）或干净架构（Clean Architecture），是一种软件架构模式，强调应用程序核心业务逻辑与其交互的外部系统之间的关注点分离。在这种模式下，核心业务逻辑位于架构的中心，由适配器环绕，使其能够与外部世界交互。适配器可以被认为是应用程序与外部系统通信的“端口”。

## 六角架构组件

1. 核心业务逻辑：这是架构的核心组件，包含应用程序的核心领域逻辑。此组件应独立于任何外部系统，并且不应受到基础设施或用户界面更改的影响。
2. 适配器：这些是将核心业务逻辑连接到外部系统的组件。它们可以被认为是应用程序与外部世界通信的“端口”。适配器可以采取多种形式，包括 API、数据库、用户界面和消息传递系统。
3. 主适配器：这是处理应用程序主要输入/输出的适配器。例如，在 Web 应用程序中，主适配器可能是接受传入请求并返回响应的 HTTP 服务器。主适配器负责将传入请求转换为可由核心业务逻辑处理的领域特定操作，并将响应转换回请求系统可以理解的格式。
4. 次要适配器：这些是处理应用程序次要输入/输出的适配器。它们可以被认为是为应用程序提供附加功能的“插件”。例如，次要适配器可能是存储应用程序数据的数据库适配器。
5. 接口：这些是定义核心业务逻辑与适配器之间通信的契约。它们确保适配器为核心业务逻辑提供必要的功能，核心业务逻辑为适配器提供必要的信息。接口可以被认为是适配器与核心业务逻辑相互沟通的“语言”。
6. 依赖：这些是应用程序依赖的外部库或服务。它们由适配器管理，不应直接被核心业务逻辑访问。这使得核心业务逻辑能保持独立于任何特定的基础设施或技术选择。

## 使用 PostgreSQL、Redis 和 Go 实践

以下是如何在实践中使用 PostgreSQL、Redis 和 Go 语言实现六角架构的方法：

1. 首先，定义核心业务逻辑。在 Go 中，您可以创建包含领域实体和服务的包，以实现与特定技术无关的核心逻辑。
2. 定义接口。在 Go 中，可以为核心业务逻辑和适配器之间的交互创建接口。这些接口定义了应用程序期望的输入和输出，以及适配器需要实现的功能。
3. 实现主适配器。在这种情况下，主适配器可以是一个 HTTP 服务器，用于处理传入的请求并返回响应。您可以使用 Go 标准库的 net/http 包或第三方库（如 gin-gonic/gin）创建一个 HTTP 服务器。
4. 实现次要适配器。在这个例子中，次要适配器可以是 PostgreSQL 和 Redis 数据库适配器。您可以使用 Go 社区提供的库，如 lib/pq（用于 PostgreSQL）和 go-redis/redis（用于 Redis），来创建和管理数据库连接，并实现接口以与核心业务逻辑进行交互。
5. 使用依赖注入将适配器与核心业务逻辑连接。在 Go 中，您可以使用依赖注入模式将适配器注入到核心业务逻辑中。这可以通过在服务结构体中定义接口字段并将适配器传递给服务的构造函数来实现。
6. 确保代码遵循 SOLID 原则和其他最佳实践。遵循 SOLID 原则和其他最佳实践将有助于确保您的代码易于维护和扩展。例如，您可以将代码组织成包，每个包都遵循单一职责原则。此外，您还可以使用测试驱动开发（TDD）方法编写测试，以确保代码的可靠性。

通过遵循这些步骤，您将能够使用 PostgreSQL、Redis 和 Go 语言实现一个遵循六角架构的应用程序。这将有助于您创建一个易于维护和扩展的代码库，同时确保核心业务逻辑与外部系统之间的清晰分离。